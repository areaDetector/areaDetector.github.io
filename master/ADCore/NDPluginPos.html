<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>NDPosPlugin &#8212; areaDetector 3-4-165-g02bc45f documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon_t.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ffmpegServer" href="ffmpegServer.html" />
    <link rel="prev" title="NDPluginTransform" href="NDPluginTransform.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          areaDetector</a>
        <span class="navbar-text navbar-version pull-left"><b>3-4</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../release.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#versions">Versions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r3-5-february-xxx-2018">R3-5 (February XXX, 2018)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r3-4-december-3-2018">R3-4 (December 3, 2018)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r3-3-2-july-9-2018">R3-3-2 (July 9, 2018)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r3-3-1-july-1-2018">R3-3-1 (July 1, 2018)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r3-3-june-27-2018">R3-3 (June 27, 2018)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r3-2-january-28-2018">R3-2 (January 28, 2018)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r3-1-july-3-2017">R3-1 (July 3, 2017)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r3-0-may-5-2017">R3-0 (May 5, 2017)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r2-6-february-22-2017">R2-6 (February 22, 2017)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r2-5-october-28-2016">R2-5 (October 28, 2016)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r2-4-september-18-2015">R2-4 (September 18, 2015)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r2-3-july-24-2015">R2-3 (July 24, 2015)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r2-2-march-23-2015">R2-2 (March 23, 2015)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r2-0-april-4-2014">R2-0 (April 4, 2014)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../release.html#r1-9-1-and-earlier">R1-9-1 and earlier</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Readme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install_guide.html">Install Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#licsense">Licsense</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#installing-and-building-from-source-code">Installing and Building from Source Code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#epics-products-required-for-building-areadetector">EPICS Products Required for Building areaDetector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#external-products-required-for-building-areadetector">External Products Required for Building areaDetector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#tiff-jpeg-xml2-and-z">TIFF, JPEG, XML2, and Z</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#hdf5-szip-and-graphics-magick">HDF5, SZIP, and GRAPHICS_MAGICK</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#downloading-and-installing-areadetector-source-code">Downloading and Installing areaDetector Source Code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#release-and-config-files">RELEASE* and CONFIG* files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#edit-release-support-local">Edit RELEASE_SUPPORT.local</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#optionally-create-release-support-local-epics-host-arch">Optionally create RELEASE_SUPPORT.local.$(EPICS_HOST_ARCH)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#optionally-create-release-base-local-epics-host-arch">Optionally create RELEASE_BASE.local.$(EPICS_HOST_ARCH)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#edit-release-libs-local">Edit RELEASE_LIBS.local</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#edit-release-prods-local">Edit RELEASE_PRODS.local</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#edit-config-site-local-and-optionally-config-site-local-epics-host-arch">Edit CONFIG_SITE.local and optionally CONFIG_SITE.local.$(EPICS_HOST_ARCH)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#edit-release-local">Edit RELEASE.local</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#make">make</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#example-files-in-adcore-iocboot">Example files in ADCore/iocBoot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#run-simdetector">Run SimDetector</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#installing-pre-built-binary-versions-of-areadetector">Installing Pre-Built Binary Versions of areaDetector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#display-managers">Display Managers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#medm">MEDM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#edm">EDM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#css">CSS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install_guide.html#caqtdm">caQtDM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#running-the-ioc-application">Running the IOC Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#image-viewers">Image Viewers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../detectors.html">Supported Detectors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../detectors.html#commuinity-supported-detectors">Commuinity Supported Detectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detectors.html#areadetector-camera-drivers-supplied-by-3rd-parties">areaDetector camera drivers supplied by 3rd parties</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../legacy_versions.html">Legacy Versions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../legacy_versions.html#required-modules">Required Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../legacy_versions.html#installation-and-building">Installation and Building</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../user_guide.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="arch.html">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="asynPortDriver.html">asynPortDriver</a></li>
<li class="toctree-l2"><a class="reference internal" href="NDArray.html">NDArray</a><ul>
<li class="toctree-l3"><a class="reference internal" href="NDArray.html#id1">NDArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDArray.html#ndarraypool">NDArrayPool</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDArray.html#ndattribute">NDAttribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDArray.html#ndattributelist">NDAttributeList</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDArray.html#pvattribute">PVAttribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDArray.html#paramattribute">paramAttribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDArray.html#functattribute">functAttribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDArray.html#asynndarraydriver">asynNDArrayDriver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../detector_drivers.html">Detector Drivers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ADDriver.html">ADDriver</a></li>
<li class="toctree-l3"><a class="reference internal" href="guidelines.html">Guidelines and rules for drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADFastCCD/index.html">areaDetector FastCCD driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADProsilica/ADProsilica.html">areaDetector Prosilica driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADPointGrey/PointGreyDoc.html">Point Grey areaDetector driver</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="plugins.html">areaDetector Plugins</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plugin_overview.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginDriver.html">NDPluginDriver</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugin_guidelines.html">Guidelines and rules for plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugin_medm.html">Base class medm screens</a></li>
<li class="toctree-l3"><a class="reference internal" href="common_plugins.html">commonPlugins.cmd</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugin_performance.html">Performance example</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginAttrPlot.html">NDPluginAttrPlot</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginAttribute.html">NDPluginAttribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginCircularBuff.html">NDPluginCircularBuff</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginCodec.html">NDPluginCodec</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginColorConvert.html">NDPluginColorConvert</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginFFT.html">NDPluginFFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginFile.html">NDPluginFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginGather.html">NDPluginGather</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginOverlay.html">NDPluginOverlay</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginProcess.html">NDPluginProcess</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginPva.html">NDPluginPva</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginROI.html">NDPluginROI</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginROIStat.html">NDPluginROIStat</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginScatter.html">NDPluginScatter</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginStats.html">NDPluginStats</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginStdArrays.html">NDPluginStdArrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginTimeSeries.html">NDPluginTimeSeries</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginTransform.html">NDPluginTransform</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">NDPosPlugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="ffmpegServer.html">ffmpegServer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="medm.html">MEDM screens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADViewers/ad_viewers.html">areaDetector Viewers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ADViewers/ad_viewers.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADViewers/ad_viewers.html#imagej-viewers">ImageJ Viewers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADViewers/ad_viewers.html#imagej-controller-epics-ad-controller-java">ImageJ Controller (EPICS_AD_Controller.java)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADViewers/ad_viewers.html#imagej-gaussian-profiler-gaussianprofiler-java">ImageJ Gaussian Profiler (GaussianProfiler.java)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADViewers/ad_viewers.html#idl-viewer">IDL Viewer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADViewers/ad_viewers.html#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../acknowledgements.html">Acknowledgements and licenses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../doxygen.html">Source Code Documentation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">NDPosPlugin</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#xml-defined-positions">XML Defined Positions</a></li>
<li><a class="reference internal" href="#using-the-plugin">Using the plugin</a></li>
<li><a class="reference internal" href="#frame-identification-tracking">Frame Identification tracking</a></li>
<li><a class="reference internal" href="#parameters-and-records">Parameters and Records</a></li>
<li><a class="reference internal" href="#screen-shots">Screen Shots</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="NDPluginTransform.html" title="Previous Chapter: NDPluginTransform"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; NDPluginTransform</span>
    </a>
  </li>
  <li>
    <a href="ffmpegServer.html" title="Next Chapter: ffmpegServer"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">ffmpegServer &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/ADCore/NDPluginPos.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="ndposplugin">
<h1><a class="toc-backref" href="#id1">NDPosPlugin</a><a class="headerlink" href="#ndposplugin" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">author:</th><td class="field-body">Alan Greer (Observatory Sciences)</td>
</tr>
</tbody>
</table>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#ndposplugin" id="id1">NDPosPlugin</a><ul>
<li><a class="reference internal" href="#overview" id="id2">Overview</a></li>
<li><a class="reference internal" href="#xml-defined-positions" id="id3">XML Defined Positions</a></li>
<li><a class="reference internal" href="#using-the-plugin" id="id4">Using the plugin</a></li>
<li><a class="reference internal" href="#frame-identification-tracking" id="id5">Frame Identification tracking</a></li>
<li><a class="reference internal" href="#parameters-and-records" id="id6">Parameters and Records</a></li>
<li><a class="reference internal" href="#screen-shots" id="id7">Screen Shots</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id2">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>NDPosPlugin can be used to attach positional information to NDArrays in
the form of NDAttributes. This plugin accepts an XML description of the
position data and then attaches each position to NDArrays as they are
passed through the plugin. Each position can contain a set of index
values and each index is attached as a separate NDAttribute. The plugin
operates using a FIFO and new positions can be added to the queue while
the plugin is actively attaching position data. When used in conjunction
with the HDF5 writer (<a class="reference internal" href="NDFileHDF5.html"><span class="doc">NDFileHDF5</span></a>) it is possible
to store NDArrays in an arbitrary pattern within a multi-dimensional
dataset.</p>
<p>The NDPosPlugin plugin is created with the <code class="docutils literal notranslate"><span class="pre">NDPosPluginConfigure</span></code> command,
either from C/C++ or from the EPICS IOC shell.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">NDPosPluginConfigure</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">portName</span><span class="p">,</span> <span class="kt">int</span> <span class="n">queueSize</span><span class="p">,</span> <span class="kt">int</span> <span class="n">blockingCallbacks</span><span class="p">,</span>
                     <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">NDArrayPort</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NDArrayAddr</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">maxMemory</span><span class="p">,</span>
                     <span class="kt">int</span> <span class="n">priority</span><span class="p">,</span> <span class="kt">int</span> <span class="n">stackSize</span><span class="p">)</span>
</pre></div>
</div>
<p>For details on the meaning of the parameters to this function refer to
the detailed documentation on the NDPosPluginConfigure function in the
<a class="reference external" href="../areaDetectorDoxygenHTML/_n_d_file_h_d_f5_8cpp.html">NDPosPlugin.cpp
documentation</a>
and in the documentation for the constructor for the <a class="reference external" href="../areaDetectorDoxygenHTML/class_n_d_file_h_d_f5.html">NDPosPlugin
class</a>.</p>
</div>
<div class="section" id="xml-defined-positions">
<h2><a class="toc-backref" href="#id3">XML Defined Positions</a><a class="headerlink" href="#xml-defined-positions" title="Permalink to this headline">¶</a></h2>
<p>The position data is supplied to the plugin as an XML description. The
parameter <strong>NDPos_Filename</strong> can either accept the full path to an XML
file with the position data description, or the XML can be injected
directly into the parameter. There is a 1,000,000 byte limit on the
parameter, but multiple injections can take place in sequence with each
set of points appended to the FIFO.</p>
<p>The XML definition contains the following 4 main elements: dimensions,
dimension, positions, and position.</p>
<ul class="simple">
<li><strong>dimensions:</strong> Contains the dimension elements that provide the
dimension name definitions</li>
<li><strong>dimension:</strong> The name of a dimension. This name is used for the
NDAttribute name that is attached to the NDArray with position
information.</li>
<li><strong>positions:</strong> Contains the position elements.</li>
<li><strong>position:</strong> Represent a single position to be added to the FIFO.</li>
</ul>
<p>The XML can contain any number of dimension elements (grouped within the
dimensions element), and each dimension must contain a single attribute
<strong>name</strong> that names the particular dimension. Once the dimensions have
been defined, the position elements are added. The XML can contain any
number of position elements (grouped within the positions element). Each
position element should have an attribute for each of the named
dimensions with the value of the position for that dimension. An example
of a simple XML description is presented below:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;pos_layout&gt;</span>
    <span class="nt">&lt;dimensions&gt;</span>
        <span class="nt">&lt;dimension</span> <span class="na">name=</span><span class="s">&quot;x&quot;</span><span class="nt">&gt;&lt;/dimension&gt;</span>
        <span class="nt">&lt;dimension</span> <span class="na">name=</span><span class="s">&quot;y&quot;</span><span class="nt">&gt;&lt;/dimension&gt;</span>
        <span class="nt">&lt;dimension</span> <span class="na">name=</span><span class="s">&quot;z&quot;</span><span class="nt">&gt;&lt;/dimension&gt;</span>
    <span class="nt">&lt;/dimensions&gt;</span>
    <span class="nt">&lt;positions&gt;</span>
        <span class="nt">&lt;position</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;&lt;/position&gt;</span>
        <span class="nt">&lt;position</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span> <span class="na">z=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;&lt;/position&gt;</span>
        <span class="nt">&lt;position</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">y=</span><span class="s">&quot;1&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;&lt;/position&gt;</span>
        <span class="nt">&lt;position</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">y=</span><span class="s">&quot;1&quot;</span> <span class="na">z=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;&lt;/position&gt;</span>
        <span class="nt">&lt;position</span> <span class="na">x=</span><span class="s">&quot;1&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;&lt;/position&gt;</span>
        <span class="nt">&lt;position</span> <span class="na">x=</span><span class="s">&quot;1&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span> <span class="na">z=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;&lt;/position&gt;</span>
        <span class="nt">&lt;position</span> <span class="na">x=</span><span class="s">&quot;1&quot;</span> <span class="na">y=</span><span class="s">&quot;1&quot;</span> <span class="na">z=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;&lt;/position&gt;</span>
        <span class="nt">&lt;position</span> <span class="na">x=</span><span class="s">&quot;1&quot;</span> <span class="na">y=</span><span class="s">&quot;1&quot;</span> <span class="na">z=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;&lt;/position&gt;</span>
    <span class="nt">&lt;/positions&gt;</span>
<span class="nt">&lt;/pos_layout&gt;</span>
</pre></div>
</div>
<p>In the example above, three dimensions have been defined (x, y and z).
The positions are then defined with value for each dimension provided.
This XML description will result in three NDAttriubtes being attached to
each NDArray, with the names x, y and z respectively. The value of each
of the NDAttributes will be set according to the position that is
currently at the front of the FIFO.</p>
<p>A complete example XML layout file is provided in
“ADCore/iocBoot/pos_plugin_demo.xml”.</p>
<p>An XML schema is provided in “ADCore/iocBoot/pos_plugin_schema.xsd”. The
schema defines the syntax that is allowed in the user’s XML definition.
It can also be used with the ‘xmllint’ command to validate a user’s XML
definition:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>xmllint --noout --schema ADCore/iocBoot/pos_plugin_schema.xsd /path/to/users/layout.xml
</pre></div>
</div>
</div>
<div class="section" id="using-the-plugin">
<h2><a class="toc-backref" href="#id4">Using the plugin</a><a class="headerlink" href="#using-the-plugin" title="Permalink to this headline">¶</a></h2>
<p>The plugin offers two modes of operation: <strong>Discard</strong> and <strong>Keep</strong>. When
executed in discard mode the plugin will throw away a position every
time it is attached to an NDArray, and the FIFO will continue to
decrease in size until it reaches zero. When executed in Keep mode the
positions will still be sent in order but they will not be discarded. A
parameter can be used to reset the current position to the start and
then the same set can be reused. The position attachment can be started
and stopped, and the FIFO can be cleared. A record of the number of
positions in the FIFO, the current index and a string representation of
the last position sent are provided through the parameter interface.</p>
</div>
<div class="section" id="frame-identification-tracking">
<h2><a class="toc-backref" href="#id5">Frame Identification tracking</a><a class="headerlink" href="#frame-identification-tracking" title="Permalink to this headline">¶</a></h2>
<p>The plugin tracks frame information to ensure that the incoming frames
are in the correct order and there are no missing or duplicated frames.
This is achieved using three parameters, <strong>IDName</strong>, <strong>IDStart</strong> and
<strong>IDDifference</strong>. The IDName tells the plugin which incoming attribute
to use as the ID to track, or if it is left empty then the uniqueId
member variable of the NDArray is used. The IDStart value informs this
plugin of the first expected ID when the acquisition is started, and the
IDDifference informs this plugin of the expected delta ID between each
frame. An IDStart of 5 and IDDifference of 10 would result in the plugin
expecting the following sequence of ID values attached to the incoming
frames: 5,15,25,35… If incoming frames contain IDs that are greater
than the expected ID then the plugin will print a warning and throw away
any position information up until the expected ID matches the frame ID;
this is a case where the frames are assumed to have been dropped. If
incoming frames contain IDs that are less than the exptected ID then the
plugin will print an error and drop the frames until the incoming frame
ID matches the expected ID. This is a more serious case of the plugin
dropping frames and this is why the error is printed. In both of these
error situations the plugin will record the event into the corresponding
counter and continue to process frames.</p>
</div>
<div class="section" id="parameters-and-records">
<h2><a class="toc-backref" href="#id6">Parameters and Records</a><a class="headerlink" href="#parameters-and-records" title="Permalink to this headline">¶</a></h2>
<table class="table table-bordered">
  <tbody>
    <tr>
      <td align="center" colspan="7,">
        <b>Parameter Definitions and EPICS Record Definitions in NDPosPlugin.template</b>
      </td>
    </tr>
    <tr>
      <th>
        Parameter index variable</th>
      <th>
        asyn interface</th>
      <th>
        Access</th>
      <th>
        Description</th>
      <th>
        drvInfo string</th>
      <th>
        EPICS record name</th>
      <th>
        EPICS record type</th>
    </tr>
    <tr>
      <td align="center" colspan="7,">
        <b>XML Position Definition</b></td>
    </tr>
    <tr>
      <td>
        NDPos_Filename</td>
      <td>
        asynOctet</td>
      <td>
        r/w</td>
      <td>
        XML filename, pointing to an XML position set description<br />
        This waveform also supports loading raw XML code directly; up to a maximum of 1,000,000
        Bytes long (NELM=1,000,000).</td>
      <td>
        NDPos_Filename</td>
      <td>
        $(P)$(R)FileName<br />
        $(P)$(R)FileName_RBV</td>
      <td>
        waveform</td>
    </tr>
    <tr>
      <td>
        NDPos_FileValid</td>
      <td>
        asynInt32</td>
      <td>
        r/o</td>
      <td>
        Flag to report the validity (xml syntax only) of the loaded XML. Updated when the
        NDPos_Filename is updated with a new filename.</td>
      <td>
        NDPos_FileValid</td>
      <td>
        $(P)$(R)FileValid_RBV</td>
      <td>
        bi</td>
    </tr>
    <tr>
      <td align="center" colspan="7,">
        <b>Execution</b></td>
    </tr>
    <tr>
      <td>
        NDPos_Running</td>
      <td>
        asynInt32</td>
      <td>
        r/w</td>
      <td>
        Start or stop appending of position data to NDArrays.</td>
      <td>
        NDPos_Running</td>
      <td>
        $(P)$(R)Running<br />
        $(P)$(R)Running_RBV</td>
      <td>
        busy<br />
        bi</td>
    </tr>
    <tr>
      <td>
        NDPos_Restart</td>
      <td>
        asynInt32</td>
      <td>
        r/w</td>
      <td>
        Reset the current position index to zero (front of FIFO) when executing in <b>Keep</b>
        mode. Has no effect if executing in <b>Discard</b> mode.</td>
      <td>
        NDPos_Restart</td>
      <td>
        $(P)$(R)Reset</td>
      <td>
        bo</td>
    </tr>
    <tr>
      <td>
        NDPos_Delete</td>
      <td>
        asynInt32</td>
      <td>
        r/w</td>
      <td>
        Delete any position data in the FIFO. If the plugin is running then this will stop
        the plugin. The size and current index will both be set to zero.</td>
      <td>
        NDPos_Delete</td>
      <td>
        $(P)$(R)Delete</td>
      <td>
        bo</td>
    </tr>
    <tr>
      <td>
        NDPos_Mode</td>
      <td>
        asynInt32</td>
      <td>
        r/w</td>
      <td>
        Select the mode of operation, <b>Discard</b> or <b>Keep</b>. Discard mode throws
        away each position once it has been attached to an NDArray, whereas Keep mode keeps
        the value and traverses through the FIFO, reatining all position data.</td>
      <td>
        NDPos_Mode</td>
      <td>
        $(P)$(R)Mode<br />
        $(P)$(R)Mode_RBV</td>
      <td>
        bo<br />
        bi</td>
    </tr>
    <tr>
      <td>
        NDPos_IDName</td>
      <td>
        asynOctet</td>
      <td>
        r/w</td>
      <td>
        Use this attribute name for the incoming frame IDs. If this parameter is left empty
        then the incoming frame's uniqueId is used for the index count.</td>
      <td>
        NDPos_IDName</td>
      <td>
        $(P)$(R)IDName<br />
        $(P)$(R)IDName_RBV</td>
      <td>
        stringout<br />
        stringin</td>
    </tr>
    <tr>
      <td>
        NDPos_IDStart</td>
      <td>
        asynInt32</td>
      <td>
        r/w</td>
      <td>
        When a new acquisition is started this value is the expected ID for the first processed
        frame.</td>
      <td>
        NDPos_IDName</td>
      <td>
        $(P)$(R)IDStart<br />
        $(P)$(R)IDStart_RBV</td>
      <td>
        longout<br />
        longin</td>
    </tr>
    <tr>
      <td>
        NDPos_IDDifference</td>
      <td>
        asynInt32</td>
      <td>
        r/w</td>
      <td>
        This value represents the delta ID between each processed frame, and is useful is
        frames are processed by plugins before reaching this plugin (eg integration of several
        frames into one). If the start ID is set to 1 and this parameter is set to 2 then
        the expected IDs would be 1,3,5,7,9....</td>
      <td>
        NDPos_IDDifference</td>
      <td>
        $(P)$(R)IDDifference<br />
        $(P)$(R)IDDifference_RBV</td>
      <td>
        longout<br />
        longin</td>
    </tr>
    <tr>
      <td align="center" colspan="7,">
        <b>Information</b></td>
    </tr>
    <tr>
      <td>
        NDPos_CurrentQty</td>
      <td>
        asynInt3264</td>
      <td>
        r/o</td>
      <td>
        Current number of position points in the FIFO.</td>
      <td>
        NDPos_CurrentQty</td>
      <td>
        $(P)$(R)Qty_RBV</td>
      <td>
        longin</td>
    </tr>
    <tr>
      <td>
        NDPos_CurrentIndex</td>
      <td>
        asynInt32</td>
      <td>
        r/o</td>
      <td>
        Current index of pointer to position within FIFO (0 for Discard mode).</td>
      <td>
        NDPos_CurrentIndex</td>
      <td>
        $(P)$(R)Index_RBV</td>
      <td>
        longin</td>
    </tr>
    <tr>
      <td>
        NDPos_CurrentPos</td>
      <td>
        asynOctet</td>
      <td>
        r/o</td>
      <td>
        String representation of the last position to be attached to an NDArray.</td>
      <td>
        NDPos_CurrentPos</td>
      <td>
        $(P)$(R)Position_RBV</td>
      <td>
        stringin</td>
    </tr>
    <tr>
      <td>
        NDPos_MissingFrames</td>
      <td>
        asynInt32</td>
      <td>
        r/w</td>
      <td>
        Counter of the number of missed/dropped frames. Write a 0 to the parameter to reset.
      </td>
      <td>
        NDPos_MissingFrames</td>
      <td>
        $(P)$(R)Missing<br />
        $(P)$(R)Missing_RBV</td>
      <td>
        longout<br />
        longin</td>
    </tr>
    <tr>
      <td>
        NDPos_DuplicateFrames</td>
      <td>
        asynInt32</td>
      <td>
        r/w</td>
      <td>
        Counter of the number of duplicated frames. Write a 0 to the parameter to reset.
      </td>
      <td>
        NDPos_DuplicateFrames</td>
      <td>
        $(P)$(R)Duplicate<br />
        $(P)$(R)Duplicate_RBV</td>
      <td>
        longout<br />
        longin</td>
    </tr>
  </tbody>
</table></div>
<div class="section" id="screen-shots">
<h2><a class="toc-backref" href="#id7">Screen Shots</a><a class="headerlink" href="#screen-shots" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/NDPluginPos.png" src="../_images/NDPluginPos.png" />
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Mark Rivers.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>