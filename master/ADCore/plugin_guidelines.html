<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Guidelines and rules for plugins &#8212; areaDetector R3-4-71-gd42b320 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/lbco_32.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Base class medm screens" href="plugin_medm.html" />
    <link rel="prev" title="NDPluginDriver" href="NDPluginDriver.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          areaDetector</a>
        <span class="navbar-text navbar-version pull-left"><b>R3-4-71-gd42b320</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../release.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#versions">Versions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Readme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install_guide.html">Install Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#licsense">Licsense</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#installing-and-building-from-source-code">Installing and Building from Source Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#downloading-and-installing-areadetector-source-code">Downloading and Installing areaDetector Source Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#installing-pre-built-binary-versions-of-areadetector">Installing Pre-Built Binary Versions of areaDetector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#display-managers">Display Managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#running-the-ioc-application">Running the IOC Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#image-viewers">Image Viewers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../detectors.html">Supported Detectors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../detectors.html#commuinity-supported-detectors">Commuinity Supported Detectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detectors.html#areadetector-camera-drivers-supplied-by-3rd-parties">areaDetector camera drivers supplied by 3rd parties</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../legacy_versions.html">Legacy Versions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../legacy_versions.html#required-modules">Required Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../legacy_versions.html#installation-and-building">Installation and Building</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../user_guide.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="arch.html">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="asynPortDriver.html">asynPortDriver</a></li>
<li class="toctree-l2"><a class="reference internal" href="NDArray.html">NDArray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detector_drivers.html">Detector Drivers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="plugins.html">areaDetector Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="medm.html">MEDM screens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADViewers/ad_viewers.html">areaDetector Viewers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../acknowledgements.html">Acknowledgements and licenses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../doxygen.html">Source Code Documentation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Guidelines and rules for plugins</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="NDPluginDriver.html" title="Previous Chapter: NDPluginDriver"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; NDPluginDriver</span>
    </a>
  </li>
  <li>
    <a href="plugin_medm.html" title="Next Chapter: Base class medm screens"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Base class me... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/ADCore/plugin_guidelines.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="guidelines-and-rules-for-plugins">
<h1>Guidelines and rules for plugins<a class="headerlink" href="#guidelines-and-rules-for-plugins" title="Permalink to this headline">Â¶</a></h1>
<p>The following are guidelines and rules for writing plugins</p>
<ul class="simple">
<li>Plugins will almost always implement the <code class="docutils literal notranslate"><span class="pre">processCallbacks()</span></code> function.
This function will be called with an NDArray pointer each time an
NDArray callback occurs. This function will normally call the
<code class="docutils literal notranslate"><span class="pre">NDPluginDriver::processCallbacks()</span></code> base class function, which handles
tasks common to all plugins, including callbacks with information
about the array, etc.</li>
<li>Plugins will generally implement one or more of the <code class="docutils literal notranslate"><span class="pre">writeInt32()</span></code>,
<code class="docutils literal notranslate"><span class="pre">writeFloat64()</span></code> or <code class="docutils literal notranslate"><span class="pre">writeOctet()</span></code> functions if they need to act
immediately on a new value of a parameter. For many parameters it is
normally sufficient to simply have them written to the parameter
library, and not to handle them in the writeXXX() functions. The
parameters are then retrieved from the parameter library with the
<code class="docutils literal notranslate"><span class="pre">getIntParam()</span></code>, <code class="docutils literal notranslate"><span class="pre">getDoubleParam()</span></code>, or <code class="docutils literal notranslate"><span class="pre">getStringParam()</span></code> function calls
when they are needed.</li>
<li>If the <code class="docutils literal notranslate"><span class="pre">writeInt32()</span></code>, <code class="docutils literal notranslate"><span class="pre">writeFloat64()</span></code> or <code class="docutils literal notranslate"><span class="pre">writeOctet()</span></code> functions are
implemented they <strong>must</strong> call the base class function for parameters
that they do not handle and whose parameter index value is less than
the first parameter of this class, i.e. parameters that belong to a
base class.</li>
<li>Plugins will need to call the <code class="docutils literal notranslate"><span class="pre">createParam()</span></code> function in their
constructor if they have additional parameters beyond those in the
asynPortDriver or NDPluginDriver base classes.</li>
<li>Plugins may <strong>never</strong> modify the NDArray that they receive in the
<code class="docutils literal notranslate"><span class="pre">processCallbacks()</span></code> function. The reason is that other plugins may be
concurrently operating on the same NDArray, since each is passed the
same pointer. This means also that when getting the attributes for
this plugin that
<code class="docutils literal notranslate"><span class="pre">asynNDArrayDriver::getAttributes(pArray-&gt;pAttributeList)</span></code> must not be
called with the NDArray passed to <code class="docutils literal notranslate"><span class="pre">processCallbacks()</span></code>, because that
will modify the NDArray attribute list, and hence the NDArray that
other plugins are operating on. Plugins such as NDPluginROI and
NDPluginColorConvert create new NDArrays via <code class="docutils literal notranslate"><span class="pre">NDArrayPool::copy()</span></code> or
<code class="docutils literal notranslate"><span class="pre">NDArrayPool::convert()</span></code> (which copy the attributes to the new array)
and then call <code class="docutils literal notranslate"><span class="pre">getAttributes(pArray-&gt;pAttributeList)</span></code> with the new
array.</li>
<li>Plugins must release their mutex by calling <code class="docutils literal notranslate"><span class="pre">this-&gt;unlock()</span></code> when they
do time-consuming operations. If they do not then they will not be
able to queue new NDArrays callbacks or obtain new parameter values.
Obviously they must not access memory locations that other threads
could modify during this time, so they should only access local
variables, not class variables (which includes the parameter
library).</li>
<li>If plugins generate new or modified NDArrays then they must call
<code class="docutils literal notranslate"><span class="pre">NDPluginDriver::doNDArrayCallbacks()</span></code> so that registered clients can
get the values of the new arrays.</li>
</ul>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Mark Rivers.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>