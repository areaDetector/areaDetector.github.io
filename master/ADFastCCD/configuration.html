<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Configuration &#8212; areaDetector R3-4-73-g831ae32 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/lbco_32.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example st.cmd Startup File" href="st_cmd.html" />
    <link rel="prev" title="Implementation of standard driver parameters" href="parameters.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          areaDetector</a>
        <span class="navbar-text navbar-version pull-left"><b>R3-4-73-g831ae32</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../release.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#versions">Versions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Readme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install_guide.html">Install Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#licsense">Licsense</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#installing-and-building-from-source-code">Installing and Building from Source Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#downloading-and-installing-areadetector-source-code">Downloading and Installing areaDetector Source Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#installing-pre-built-binary-versions-of-areadetector">Installing Pre-Built Binary Versions of areaDetector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#display-managers">Display Managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#running-the-ioc-application">Running the IOC Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_guide.html#image-viewers">Image Viewers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../detectors.html">Supported Detectors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../detectors.html#commuinity-supported-detectors">Commuinity Supported Detectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detectors.html#areadetector-camera-drivers-supplied-by-3rd-parties">areaDetector camera drivers supplied by 3rd parties</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../legacy_versions.html">Legacy Versions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../legacy_versions.html#required-modules">Required Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../legacy_versions.html#installation-and-building">Installation and Building</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../user_guide.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../ADCore/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADCore/arch.html">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADCore/asynPortDriver.html">asynPortDriver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADCore/NDArray.html">NDArray</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../detector_drivers.html">Detector Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADCore/plugins.html">areaDetector Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADCore/medm.html">MEDM screens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADViewers/ad_viewers.html">areaDetector Viewers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../acknowledgements.html">Acknowledgements and licenses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../doxygen.html">Source Code Documentation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Configuration</a><ul>
<li><a class="reference internal" href="#ioc-shell">IOC Shell</a></li>
<li><a class="reference internal" href="#setting-the-image-size">Setting the image size</a></li>
<li><a class="reference internal" href="#auto-configuration-of-the-fastccd">Auto Configuration of the FastCCD</a></li>
<li><a class="reference internal" href="#connection-management">Connection management</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="parameters.html" title="Previous Chapter: Implementation of standard driver parameters"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Implementatio...</span>
    </a>
  </li>
  <li>
    <a href="st_cmd.html" title="Next Chapter: Example st.cmd Startup File"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Example st.cm... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/ADFastCCD/configuration.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h1>
<div class="section" id="ioc-shell">
<h2>IOC Shell<a class="headerlink" href="#ioc-shell" title="Permalink to this headline">¶</a></h2>
<p>The FastCCD driver is created with the FastCCDConfig command, either
from C/C++ or from the EPICS IOC shell.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">FastCCDConfig</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">portName</span><span class="p">,</span>
                  <span class="kt">int</span> <span class="n">maxBuffers</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">maxMemory</span><span class="p">,</span>
                  <span class="kt">int</span> <span class="n">priority</span><span class="p">,</span> <span class="kt">int</span> <span class="n">stackSize</span><span class="p">,</span>
                  <span class="kt">int</span> <span class="n">packetBuffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">imageBuffer</span><span class="p">,</span>
                  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">baseIP</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">fabricIP</span><span class="p">,</span>
                  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">fabricMAC</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>packetBuffer</cite> and <code class="docutils literal notranslate"><span class="pre">imageBuffer</span></code> parameters specify how many
packet frames and images to buffer in the <code class="docutils literal notranslate"><span class="pre">libcin</span></code> driver. These are
directly passed to <code class="docutils literal notranslate"><span class="pre">libcin</span></code> on initialization.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">baseIP</span></code> and <code class="docutils literal notranslate"><span class="pre">fabricIP</span></code> are the ip addresses of the base and
fabric interfaces on the camera interface node (CIN). A null “” string
sets the default as defined in the <code class="docutils literal notranslate"><span class="pre">libcin</span></code> driver.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">fabricMAC</span></code> parameter causes the <code class="docutils literal notranslate"><span class="pre">libcin</span></code> driver to set the MAC
address of the CIN on initialization. This can be used to broadcast the
image data by using the <code class="docutils literal notranslate"><span class="pre">FF:FF:FF:FF:FF</span></code> mac address.</p>
<p>For details on the meaning of the other parameters to this function
refer to the detailed documentation on the FastCCDConfig function in the
<a class="reference external" href="http://cars9.uchicago.edu/software/epics/areaDetectorDoxygenHTML/_fast_c_c_d_8cpp.html">FastCCD.cpp
documentation</a>
and in the documentation for the constructor for the <a class="reference external" href="http://cars9.uchicago.edu/software/epics/areaDetectorDoxygenHTML/class_fast_c_c_d.html">FastCCD
class</a>.</p>
</div>
<div class="section" id="setting-the-image-size">
<h2>Setting the image size<a class="headerlink" href="#setting-the-image-size" title="Permalink to this headline">¶</a></h2>
<p>Due to the multicolum nature of the FastCCD, setting the image size is
not trivial. This is due to the nature of the image descrambling and if
overscan is used on each supercolumn. For this reason the image size is
governed by two paramaters, <code class="docutils literal notranslate"><span class="pre">$(P)$(R)OverscanCols</span></code> and
<code class="docutils literal notranslate"><span class="pre">$(P)$(R)ADSizeY</span></code>.</p>
<p>The definition used for the image orientation in this driver is that
columns are along the <em>X</em> direction and rows are along the <em>Y</em>
direction. As the number of columns per <em>supercolumn</em> is fixed in timing
to 10 columns, the only free parameter is the number of overscan cols to
include and specified by the <code class="docutils literal notranslate"><span class="pre">$(P)$(R)OverscanCols</span></code> PV. For this
reason setting of the <code class="docutils literal notranslate"><span class="pre">$(P)$(R)ADSizeX</span></code> PV is ignored by the driver.
The number of rows defines how many rows per column to process and is
set by the <code class="docutils literal notranslate"><span class="pre">$(P)$(R)ADSizeY</span></code> PV.</p>
<p>The actual image size is therefore given by:</p>
<ul class="simple">
<li><em>X</em> Direction (row wise) <code class="docutils literal notranslate"><span class="pre">$(P)$(R)ADSizeY</span></code> [usually set to 2000 to
have some overscan]</li>
<li><em>Y</em> Direction (column wise) (10 + <code class="docutils literal notranslate"><span class="pre">$(P)$(R)OverscanCols</span></code>) * 96
[for no overscan 960]</li>
</ul>
</div>
<div class="section" id="auto-configuration-of-the-fastccd">
<h2>Auto Configuration of the FastCCD<a class="headerlink" href="#auto-configuration-of-the-fastccd" title="Permalink to this headline">¶</a></h2>
<p>The FastCCD can be configured by using the built in <em>firmware</em> and
settings in the <a class="reference external" href="https://github.com/NSLS-II/libcin">libcin driver</a>.
This is controled by the PVs defined in the section <em>FastCCD Auto
Setting Commands</em>. The PVs <code class="docutils literal notranslate"><span class="pre">$(P)$(R)TimingName[0..9]_RBV</span></code> show strings
with names defined in the <code class="docutils literal notranslate"><span class="pre">libcin</span></code> driver corresponding to the modes 1
through 10. To boot into one of these modes, the user should set the PV
<code class="docutils literal notranslate"><span class="pre">$(P)$(R)TimingMode</span></code> to number of the mode required (0 through 9). The
PV <code class="docutils literal notranslate"><span class="pre">$(P)$(R)TimingName_RBV</span></code> will indicate the mode selected.</p>
<p>To boot the FastCCD, the user should write 1 to the PV <code class="docutils literal notranslate"><span class="pre">$(P)$(R)Boot</span></code>.
This will cause the FastCCD to reset the CIN (by power cycling it) and
upload the firmware and timing configuration. At this point the user
should be able to see the test pattern from the CIN by triggering the
detector. The user can then configure the <em>fCRICs</em> by writing 1 to the
PV <code class="docutils literal notranslate"><span class="pre">$(P)$(R)SendFCRIC</span></code>. The bias configuration can be upload by
writing 1 to the PV <code class="docutils literal notranslate"><span class="pre">$(P)$(R)SendBias</span></code>. The latter two steps require
the camera head to be powered. This is out of the scope of this driver.</p>
</div>
<div class="section" id="connection-management">
<h2>Connection management<a class="headerlink" href="#connection-management" title="Permalink to this headline">¶</a></h2>
<p>As the FastCCD <em>CIN</em> only uses UDP sockets, there is no permanent
connection, the driver relies on being able to read such parameters as
the serial nnumber of the software to be able to confirm that
commuincation with the driver is occuring.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Mark Rivers.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>